#### 加密概述

```sh
#安全：
1.机密性
2.完整性
3.身份验证

#对称加密算法

#单向加密算法：提取数据特征码
	输入一样：输出必然相同
	雪崩效应：输入的微小改变，将会引起结果的巨大改变
	定长输出：无论原始数据多大，结果大小都是相同的
	不可逆：无法根据特征码还原原来的数据
	
#密钥交换：（Internet Key Exchange，IKE）
Diffie-Hellman协议：
	A -> B	#A和B通信
		p,g		#通信数据，p:大素数，g：生成数
	A:x		#本地数x
	B:y		#本地数y
	A:g^x%p -> B
	B:g^y%p -> A
	#此时网络传输数据：p,g,g^x%p,g^y%p		#根据离散对数原理，x和y几乎无法被反推
	A:(g^y%p)^x = g^xy%p
	B:(g^x%p)^y = g^xy%p
	#此时g^xy%p即为密钥
	
#公钥加密算法：非对称加密
	密钥对：
		公钥：P		#公钥提取自私钥
		私钥：s		#一般很长
	发送方用自己的私钥加密数据，可以实现身份验证
	发送方用对方的公钥加密，可以保证数据机密性
	#公钥加密算法很少用来加密数据，速度太慢，主要用于身份验证
	
#加密总思路：（PKI:public key infrastructure）
1.通信前，获取证书（包含公钥）	#经第三方权威证书颁发机构确认
2.通信双方通过密钥交换算法生成仅双方知晓的对称密钥
3.单向加密方式加密数据，提取特征码
4.使用非对称加密方式（确保身份验证）
	私钥加密特征码
5.对称加密方式加密所有通信数据
	如果对方公钥能正常解密数据并校验特征码，则数据无篡改，数据正常（同时表明发送方身份得到验证）
	反之，说明数据丢失损坏或者被篡改
	
	
#ssl加密算法过程：
0.开始3次握手
1.客户端发起请求
2.服务端协商对称加密协议（ssl，及版本等）
3.服务端返回证书
4.客户端生成随机数会话对称密钥，用证书公钥加密，发给服务端
5.服务端接收对称密钥
6.通信
```

#### 常见加密算法

```sh
#常见加密算法：
对称加密：
	DES		#Data Encrptiion Standard (56bit)
	3DES
	AES		#Advanced Encrption Standard，AES192,AES256,AES512
	Blowfish
	
单向加密：
	MD4
	MD5
	SHA1
	SHA192,SHA256,SHA384
	CRC-32		#校验
	
公钥加密：	（加密/签名）
	RSA		#加密，签名
	DSA		#仅用于签名
	ElGamal
```

#### OpenSSL

```sh
#说明：
#SSL的开源软件实现
#几乎实现当下所有的加密算法，性能优秀

#组件：
	libcrypto	#加密库
	libssl		#TLS/SSL的实现，基于会话的，实现了身份认证，数据机密和会话完整性的库
	openssl		#多用途命令行工具 （还可实现私有证书颁发机构）
		help	#参数，可以查看标准子命令
		speed	#测试算法加密速度
			#示例：
			openssl speed des	#测试des算法速度

#实现私有CA：
1.生成一对密钥
	openssl genrsa		#生成一个rsa私钥
	openssl genrsa 2048 > key.file	#生成2048长度的密钥写入到key.file文件（记得修改权限）
	(umask 077;openssl genrsa -out key.file 2048)	#生成默认当前用户有权限的密钥文件
	openssl rsa -in key.file -pubout		#根据私钥，输出公钥
2.生成自签证书 (证书签发服务器自己使用)
	openssl req -new -x509 -key key.file -out file.crt -days 365	#生成自有证书示例
	openssl x509 -text -in file.crt		#查看证书信息
3.请求颁发证书 (服务器使用)
	openssl req -new -key key.file -out server.csr	#生成证书请求文件myserver.csr，发送给证书签发服务器
4.证书签发服务器生成证书
	openssl ca -in server.csr -out server.crt -days 365	#生成证书

#openssl配置文件（路径: /etc/pki/tls/openssl.cnf）

```

#### OpenSSH

```sh
#说明：
#远程登录工具，遵循ssh协议，端口22
#sshv1不安全，sshv2安全
#openssh(ssh,sshd)

#客户端
	Linux:ssh
	Windows:putty, SecureCRT, SSHSecureShellClient

#服务器端：
	sshd
	
#通信思路（基于口令）：
1.客户端发起请求
2.服务端返回公钥指纹，并请求客户端确认
3.客户端确认后，接受公钥，生成对称密钥
4.客户端用户名密码加密，发起登录
5.服务端验证通过，ssh会话通道建立
6.正常通信

#通信思路（基于密钥）：
1.客户端生成私钥和公钥，私钥保留，公钥发送给五服务器 #注意：此处公钥仅服务器知道
2.通信过程中，客户端私钥生成签名数据，服务器能验证正常，则身份验证通过

#openssh配置文件
	 客户端：/etc/ssh/ssh_config
	 服务端：/etc/ssh/sshd_config

#ssh进程可能有多个（一个连接会产生一个sshd子进程）

#sshd服务脚本位置：/etc/init.d/sshd
```

#### https

```sh
#443端口
#ssl会话基于ip地址

#流程：
1.服务器向CA服务器申请证书，配置证书
2.客户端和服务端tcp通信，服务端向客户端发放证书
3.客户端从CA下载证书，保存本地，与服务端发过来的证书比对，如一致则建立通信
4.客户端发送对称密钥，服务端根据对称密钥加密数据，实现与客户端加密通信

#ssl证书配置：

```

